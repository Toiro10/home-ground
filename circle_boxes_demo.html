<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Correct Answer Accumulation</title>

<style>
  body {
    margin: 0;
    background: #fff;
  }

  /* カメラ（固定） */
  .row-wrapper {
    position: relative;
    width: 100vw;
    height: 200px;
    overflow: hidden;
    background: #fff;
    font-family: system-ui, sans-serif;
  }

  /* セルが溜まっていく列 */
  .circle-row {
    position: absolute;
    right: 60px; /* 右端に発生源 */
    top: 70px;
    display: flex;
    gap: 40px;
    will-change: transform;
  }

  /* □＋○ セット */
  .cell {
    position: relative;
    width: 60px;
    height: 60px;
    flex-shrink: 0;
  }

  .cell-box {
    position: absolute;
    bottom: 0;
    left: 12px;
    width: 36px;
    height: 36px;
    border: 1.5px solid #000;
    box-sizing: border-box;
  }

  .cell-circle {
    position: absolute;
    inset: 0;
    border: 4px solid red;
    border-radius: 50%;
    opacity: 0;
    transform: scale(0.6);
    transition: opacity 0.25s ease, transform 0.25s ease;
  }

  .cell.active .cell-circle {
    opacity: 1;
    transform: scale(1);
  }

  /* 白フェード */
  .white-cover {
    position: absolute;
    inset: 0;
    background: #fff;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.8s ease;
  }

  .white-cover.show {
    opacity: 1;
  }

  /* 最後の文章（仮） */
  .caption {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    opacity: 0;
    transition: opacity 0.8s ease;
  }

  .caption.show {
    opacity: 1;
  }

</style>
</head>

<body>

<div class="row-wrapper">
  <div class="circle-row" id="row"></div>
  <div class="white-cover" id="cover"></div>
  <div class="caption" id="caption">
    彼の善良さは、空欄を埋めるだけで生まれている。
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const row = document.getElementById("row");
  const cover = document.getElementById("cover");
  const caption = document.getElementById("caption");

  let shift = 0;
  let interval = 500;
  let count = 0;
  const maxCells = 40;

  function createCell() {
    const cell = document.createElement("div");
    cell.className = "cell";
    cell.innerHTML = `
      <div class="cell-box"></div>
      <div class="cell-circle"></div>
    `;
    return cell;
  }

  function step() {
    if (count >= maxCells) {
      cover.classList.add("show");
      setTimeout(() => caption.classList.add("show"), 900);
      return;
    }

    const cell = createCell();
    row.appendChild(cell);

    // ○ を付ける
    setTimeout(() => cell.classList.add("active"), 100);

    // 左に押し出す（カメラは固定）
    shift += 100;
    row.style.transform = `translateX(-${shift}px)`;

    count++;

    // 加速
    interval = Math.max(70, interval * 0.82);
    setTimeout(step, interval);
  }

  // 少し溜めて開始
  setTimeout(step, 600);
});
</script>

</body>
</html>
