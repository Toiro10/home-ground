<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Circle Row Demo</title>
  <style>
    body {
      margin: 0;
      background: #ffffff;
    }

    /* オーバーレイ全体 */
    .row-wrapper {
      position: relative;
      width: 100vw;
      height: 180px;
      overflow: hidden;
      background: #ffffff;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
    }

    /* 流れていく横一列（カメラ＝viewportは固定、列が右→左へ動く） */
    .circle-row {
      position: absolute;
      top: 60px;
      left: 100%; /* 画面の右の外からスタート */
      display: flex;
      flex-direction: row-reverse; /* DOMの先頭セルが「右端」に来るようにする */
      gap: 40px;
      will-change: transform;
    }

    /* ひとつ分の □＋○ セット */
    .cell {
      position: relative;
      width: 60px;
      height: 60px;
    }

    .cell-box {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 36px;
      height: 36px;
      border: 1px solid #000;
      background: transparent;
    }

    .cell-circle {
      position: absolute;
      top: 0;
      left: 0;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 4px solid red;
      box-sizing: border-box;
      opacity: 0;
      transform: scale(0.7);
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .cell.active .cell-circle {
      opacity: 1;
      transform: scale(1);
    }

    /* 右→左に流れるアニメーション（列そのものが動く） */
    .circle-row.animate {
      animation: slide-left 6s linear forwards;
    }

    @keyframes slide-left {
      0% {
        transform: translateX(0); /* 画面右の外 */
      }
      100% {
        transform: translateX(-2600px); /* 充分左に抜けるくらいまで */
      }
    }

    /* 最後にかぶさるホワイトフェード */
    .white-cover {
      position: absolute;
      inset: 0;
      background: #ffffff;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.8s ease;
    }

    .white-cover.show {
      opacity: 1;
    }

    /* 中央テキスト（今回はデモ用） */
    .caption {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.8s ease 0.4s;
      font-size: 20px;
    }

    .caption.show {
      opacity: 1;
    }
  </style>
</head>
<body>
  <div class="row-wrapper">
    <div class="circle-row" id="circleRow">
      <!-- □＋○ を好きな数だけ並べる（DOMの先頭が「右端」になる） -->
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
      <div class="cell"><div class="cell-box"></div><div class="cell-circle"></div></div>
    </div>

    <div class="white-cover" id="whiteCover"></div>

    <div class="caption" id="caption">
      彼の善良さは、空欄を埋めるだけで生まれている。
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const row = document.getElementById("circleRow");
      const cells = Array.from(document.querySelectorAll(".cell")); // flex-direction: row-reverse なのでこれで右→左の順
      const cover = document.getElementById("whiteCover");
      const caption = document.getElementById("caption");

      // 列のスライド開始（右→左）
      row.classList.add("animate");

      // ○ を一つずつ出していく
      let index = 0;
      let interval = 450; // 最初の間隔（ms）

      function step() {
        if (index < cells.length) {
          cells[index].classList.add("active"); // ○を表示
          index++;

          // だんだん速くする（下限80ms）
          interval = Math.max(80, interval * 0.8);
          setTimeout(step, interval);
        } else {
          // 全部に○がついたら白フェード
          cover.classList.add("show");

          // その後にテキストを出す（本番ではここで hero 側のテキスト表示に切り替えでもOK）
          setTimeout(() => {
            caption.classList.add("show");
          }, 900);
        }
      }

      // 少し溜めてからスタート
      setTimeout(step, 600);
    });
  </script>

  <a href="character_b.html"
   style="
     position: fixed;
     top: 16px;
     left: 16px;
     font-size: 12px;
     color: #000;
     text-decoration: underline;
     z-index: 1000;
   ">
    ← キャラクターBに戻る
  </a>
</body>
</html>
